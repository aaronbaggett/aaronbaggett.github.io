---
title: "Reading Secure Data Into R from Dropbox"
author: Aaron R. Baggett
date: March 17, 2014
output:
  html_document:
    highlight: tango
---

It's easy to read data into R from an unsecure URL.  The base function ```url``` allows for reading a variety of file types into your current R session.  See ```?url``` for details.  However, using ```url()``` is limited to unsecure (i.e., http://) URLs.  No problem.  It's just as easy to read in data from an secure (i.e., https://) URL via the ```getURL``` function in the ```RCurl``` package.  However, let's say you'd like to read in a data file stored in Dropbox.  That's a problem.  ```getURL()``` will not parse data files from Dropbox.  Otherwise, ```getURL``` works nicely.  I ran into this connundrum over the weekend when I had a .csv file that was too large for GitHub.

### Enter Dropbox
Since 2013, [files above 50 MB](https://help.github.com/articles/working-with-large-files) are not allowed to be pushed to GitHub.  This is when storing files in Dropbox can be handy.  However, [since 2012](https://www.dropbox.com/help/16/en), Dropbox has made all public links and shared documents secure.  Still, reading data into R from a secure file location in Dropbox is not as easy as simply envoking ```getURL()```.  Luckily, [Christopher Gandrud](http://CRAN.R-project.org/package=repmis) wrote a function precisely for this purpose in his package ```repmis```.  It's as easy as envoking his ```source_DropboxData``` function.  It works like this:

```{r, tidy = FALSE, message = FALSE}
library(repmis)
dealers <- source_DropboxData(file = "dealers.csv", 
  key = "b3zskf22rz93h67", sep = ",", header = TRUE)
head(dealers)
```

The data file I'm reading into my R session is stored on my hard drive in a folder I've set to sync with Dropbox.  If you have Dropbox installed, it's easy to generate a shared link:

![alt text](http://aaronbaggett.com/img/db_screen.png)

You'll notice the ```source_DropboxData``` function is really straightforward.  In this case, the file I'm reading in is a .csv file called ```dealers.csv```, which is indicated following the ```file = ``` command.  When you generate a shared link, Dropbox will assign an alphanumeric key unique to that file's URL, which, similarly, is indicated following the ```key = ``` command.  After that, simply tell ```source_DropboxData``` what kind of character separation is being used and whether or not the file has a header, and you're set.

Let's make sure the ```dealers.csv``` data file was read in properly.

```{r, tidy = FALSE, message = FALSE, fig.width = 6, fig.height = 5.25, fig.align = "center"}
library(ggplot2)
library(wesanderson)
library(plyr)
ddply(dealers, .(appearance), summarize, 
  mean_time = mean(response_time), 
  sd_time = sd(response_time))

ggplot(data = dealers, aes(x = appearance, y = response_time, 
  fill = appearance)) + geom_boxplot(color = I("grey35")) + 
  xlab("\nCustomer Appearance") + 
  ylab("Salesman Response Time\n") +
  ggtitle("Response Times of Car Salesmen as a \nFunction of Customer Appearance\n") +
  theme_bw() + theme(legend.position = "none") +
  scale_fill_manual(values = wes.palette(3, "FantasticFox"))
```

The data file I'm reading into my R session is stored on my hard drive in a folder I've set to sync with Dropbox.  You'll notice the ```source_DropboxData``` function is really straightforward.  In this case, the file I'm reading in is a .csv file called ```dealers.csv```, which is indicated following the ```file = ``` command.  When you generate a shared link, Dropbox will assign an alphanumeric key unique to that file's URL, which, similarly, is indicated following the ```key = ``` command.  After that, simply tell ```source_DropboxData``` what kind of character separation is being used and whether or not the file has a header, and you're set.
